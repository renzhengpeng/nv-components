# Select 选择器组件测试用例

## 组件信息

- **组件名称**: nv-select
- **组件路径**: `src/components/select`
- **测试优先级**: P0 (高优先级)
- **组件描述**: 当选项过多时，使用下拉菜单展示并选择内容

## 1. 功能测试

### 1.1 基础渲染

- **测试ID**: `select-basic-render`
- **测试步骤**:
  1. 渲染一个基础选择器
  2. 验证选择器正常显示
  3. 点击选择器
  4. 验证下拉菜单展开
- **预期结果**: 选择器正常渲染，点击后下拉菜单展开

### 1.2 单选模式

- **测试ID**: `select-single-select`
- **测试步骤**:
  1. 渲染选择器和多个选项
  2. 点击选择器展开下拉菜单
  3. 点击某个选项
  4. 验证选项被选中
  5. 验证下拉菜单关闭
  6. 验证选择器显示选中的值
- **预期结果**: 单选模式正常工作，选中后菜单关闭

### 1.3 多选模式

- **测试ID**: `select-multiple-select`
- **测试步骤**:
  1. 设置 multiple 属性
  2. 点击选择器展开下拉菜单
  3. 依次点击多个选项
  4. 验证多个选项都被选中
  5. 验证下拉菜单保持打开
  6. 验证选择器显示所有选中的值（标签形式）
- **预期结果**: 多选模式正常工作，可选择多个选项

## 2. 属性测试

### 2.1 value 属性 (v-model)

- **测试ID**: `select-value`
- **测试步骤**:
  1. 设置初始 value 值
  2. 验证对应选项被选中
  3. 选择其他选项
  4. 验证 value 值更新
- **预期结果**: value 双向绑定正常工作

### 2.2 multiple 属性 - 多选

- **测试ID**: `select-multiple`
- **测试步骤**:
  1. 设置 multiple 属性
  2. 验证可以选择多个选项
  3. 验证选中的选项显示为标签
  4. 验证可以删除已选标签
- **预期结果**: 多选功能正常，标签显示和删除正常

### 2.3 disabled 属性 - 禁用状态

- **测试ID**: `select-disabled`
- **测试步骤**:
  1. 设置 disabled 属性
  2. 验证选择器显示禁用样式
  3. 尝试点击选择器
  4. 验证下拉菜单不展开
- **预期结果**: 禁用状态下无法操作

### 2.4 clearable 属性 - 可清空

- **测试ID**: `select-clearable`
- **测试步骤**:
  1. 设置 clearable 属性
  2. 选择一个选项
  3. 悬停在选择器上
  4. 验证显示清空图标
  5. 点击清空图标
  6. 验证选择被清空
- **预期结果**: 可清空功能正常工作

### 2.5 filterable 属性 - 可搜索

- **测试ID**: `select-filterable`
- **测试步骤**:
  1. 设置 filterable 属性
  2. 点击选择器
  3. 在输入框中输入搜索文本
  4. 验证选项列表被过滤
  5. 验证只显示匹配的选项
- **预期结果**: 搜索过滤功能正常工作

### 2.6 placeholder 属性 - 占位文本

- **测试ID**: `select-placeholder`
- **测试步骤**:
  1. 设置 placeholder 属性
  2. 验证未选择时显示占位文本
  3. 选择选项后验证占位文本消失
- **预期结果**: 占位文本正确显示

### 2.7 size 属性 - 尺寸

- **测试ID**: `select-size-{value}`
- **测试值**: mini, small, medium, large
- **测试步骤**:
  1. 设置不同的 size 值
  2. 验证选择器尺寸符合预期
- **预期结果**: 不同尺寸正确显示

**详细测试用例**:
| size 值 | 测试ID | 预期高度 |
|---------|--------|---------|
| mini | select-size-mini | ~24px |
| small | select-size-small | ~32px |
| medium | select-size-medium | ~36px |
| large | select-size-large | ~40px |

### 2.8 loading 属性 - 加载状态

- **测试ID**: `select-loading`
- **测试步骤**:
  1. 设置 loading 属性
  2. 验证显示加载图标
  3. 验证选择器禁用
- **预期结果**: 加载状态正确显示

### 2.9 remote 属性 - 远程搜索

- **测试ID**: `select-remote`
- **测试步骤**:
  1. 设置 remote 和 remote-method 属性
  2. 输入搜索文本
  3. 验证触发远程搜索方法
  4. 验证选项列表更新
- **预期结果**: 远程搜索功能正常

### 2.10 allow-create 属性 - 允许创建新选项

- **测试ID**: `select-allow-create`
- **测试步骤**:
  1. 设置 filterable 和 allow-create 属性
  2. 输入不存在的选项文本
  3. 按 Enter 键
  4. 验证新选项被创建并选中
- **预期结果**: 可以创建新选项

### 2.11 collapse-tags 属性 - 折叠标签

- **测试ID**: `select-collapse-tags`
- **测试步骤**:
  1. 设置 multiple 和 collapse-tags 属性
  2. 选择多个选项
  3. 验证只显示第一个标签和数量
- **预期结果**: 多选标签折叠显示

### 2.12 popper-append-to-body 属性

- **测试ID**: `select-popper-append-to-body`
- **测试步骤**:
  1. 设置 popper-append-to-body 属性
  2. 打开下拉菜单
  3. 验证下拉菜单添加到 body
- **预期结果**: 下拉菜单正确定位

## 3. 事件测试

### 3.1 change 事件

- **测试ID**: `select-event-change`
- **测试步骤**:
  1. 监听 change 事件
  2. 选择一个选项
  3. 验证 change 事件触发
  4. 验证事件参数包含选中的值
- **预期结果**: change 事件正常触发

### 3.2 visible-change 事件

- **测试ID**: `select-event-visible-change`
- **测试步骤**:
  1. 监听 visible-change 事件
  2. 点击选择器展开菜单
  3. 验证事件触发，参数为 true
  4. 点击外部关闭菜单
  5. 验证事件触发，参数为 false
- **预期结果**: 下拉菜单显示/隐藏事件正常

### 3.3 remove-tag 事件

- **测试ID**: `select-event-remove-tag`
- **测试步骤**:
  1. 设置 multiple 属性
  2. 监听 remove-tag 事件
  3. 选择多个选项
  4. 点击某个标签的删除按钮
  5. 验证 remove-tag 事件触发
  6. 验证事件参数包含被删除的值
- **预期结果**: 删除标签事件正常触发

### 3.4 clear 事件

- **测试ID**: `select-event-clear`
- **测试步骤**:
  1. 设置 clearable 属性
  2. 监听 clear 事件
  3. 选择一个选项
  4. 点击清空按钮
  5. 验证 clear 事件触发
- **预期结果**: 清空事件正常触发

### 3.5 blur 事件

- **测试ID**: `select-event-blur`
- **测试步骤**:
  1. 监听 blur 事件
  2. 点击选择器获得焦点
  3. 点击外部失去焦点
  4. 验证 blur 事件触发
- **预期结果**: 失焦事件正常触发

### 3.6 focus 事件

- **测试ID**: `select-event-focus`
- **测试步骤**:
  1. 监听 focus 事件
  2. 点击选择器
  3. 验证 focus 事件触发
- **预期结果**: 聚焦事件正常触发

## 4. 状态测试

### 4.1 聚焦状态

- **测试ID**: `select-focus-state`
- **测试步骤**:
  1. 点击选择器
  2. 验证显示聚焦样式（边框高亮）
- **预期结果**: 聚焦状态样式正确

### 4.2 禁用状态

- **测试ID**: `select-disabled-state`
- **测试步骤**:
  1. 设置 disabled 属性
  2. 验证显示禁用样式
  3. 验证鼠标悬停无效果
- **预期结果**: 禁用状态样式正确

### 4.3 选项禁用状态

- **测试ID**: `select-option-disabled`
- **测试步骤**:
  1. 设置某个选项的 disabled 属性
  2. 打开下拉菜单
  3. 验证禁用选项显示禁用样式
  4. 尝试点击禁用选项
  5. 验证无法选中
- **预期结果**: 选项禁用功能正常

## 5. 交互测试

### 5.1 鼠标点击展开/收起

- **测试ID**: `select-mouse-toggle`
- **测试步骤**:
  1. 点击选择器
  2. 验证下拉菜单展开
  3. 再次点击选择器
  4. 验证下拉菜单收起
- **预期结果**: 点击切换菜单显示状态

### 5.2 键盘 Enter 键展开

- **测试ID**: `select-keyboard-enter`
- **测试步骤**:
  1. 聚焦选择器
  2. 按 Enter 键
  3. 验证下拉菜单展开
- **预期结果**: Enter 键展开菜单

### 5.3 键盘上下箭头导航

- **测试ID**: `select-keyboard-arrow`
- **测试步骤**:
  1. 打开下拉菜单
  2. 按下箭头键
  3. 验证高亮下一个选项
  4. 按上箭头键
  5. 验证高亮上一个选项
- **预期结果**: 箭头键导航正常

### 5.4 键盘 Enter 键选择

- **测试ID**: `select-keyboard-select`
- **测试步骤**:
  1. 打开下拉菜单
  2. 使用箭头键高亮某个选项
  3. 按 Enter 键
  4. 验证选项被选中
- **预期结果**: Enter 键选择选项

### 5.5 键盘 Escape 键关闭

- **测试ID**: `select-keyboard-escape`
- **测试步骤**:
  1. 打开下拉菜单
  2. 按 Escape 键
  3. 验证下拉菜单关闭
- **预期结果**: Escape 键关闭菜单

### 5.6 点击外部关闭

- **测试ID**: `select-click-outside`
- **测试步骤**:
  1. 打开下拉菜单
  2. 点击页面其他区域
  3. 验证下拉菜单关闭
- **预期结果**: 点击外部关闭菜单

### 5.7 Tab 键导航

- **测试ID**: `select-tab-navigation`
- **测试步骤**:
  1. 聚焦第一个选择器
  2. 按 Tab 键
  3. 验证焦点移到下一个元素
- **预期结果**: Tab 键导航正常

## 6. 边界测试

### 6.1 空选项列表

- **测试ID**: `select-empty-options`
- **测试步骤**:
  1. 不提供任何选项
  2. 打开下拉菜单
  3. 验证显示"无数据"提示
- **预期结果**: 空列表显示提示信息

### 6.2 大量选项

- **测试ID**: `select-large-options`
- **测试步骤**:
  1. 提供 1000+ 个选项
  2. 打开下拉菜单
  3. 验证渲染流畅
  4. 验证可以滚动查看
- **预期结果**: 大量选项正常渲染和滚动

### 6.3 超长选项文本

- **测试ID**: `select-long-option-text`
- **测试步骤**:
  1. 提供超长文本的选项
  2. 验证文本正确显示或截断
  3. 选择该选项
  4. 验证选择器中文本正确显示
- **预期结果**: 超长文本正确处理

### 6.4 特殊字符选项

- **测试ID**: `select-special-chars`
- **测试步骤**:
  1. 提供包含特殊字符的选项
  2. 验证选项正确显示
  3. 选择该选项
  4. 验证值正确存储
- **预期结果**: 特殊字符正确处理

### 6.5 重复值选项

- **测试ID**: `select-duplicate-values`
- **测试步骤**:
  1. 提供具有相同 value 的多个选项
  2. 验证行为（可能显示警告或只显示第一个）
- **预期结果**: 重复值合理处理

### 6.6 多选全选

- **测试ID**: `select-select-all`
- **测试步骤**:
  1. 设置 multiple 属性
  2. 选择所有选项
  3. 验证所有选项都被选中
  4. 验证性能正常
- **预期结果**: 全选功能正常

### 6.7 搜索无结果

- **测试ID**: `select-search-no-result`
- **测试步骤**:
  1. 设置 filterable 属性
  2. 输入不存在的搜索文本
  3. 验证显示"无匹配数据"
- **预期结果**: 无结果提示正确显示

## 7. 可访问性测试

### 7.1 ARIA 属性 - expanded

- **测试ID**: `select-aria-expanded`
- **测试步骤**:
  1. 验证 aria-expanded="false"
  2. 打开下拉菜单
  3. 验证 aria-expanded="true"
- **预期结果**: ARIA expanded 属性正确

### 7.2 ARIA 属性 - disabled

- **测试ID**: `select-aria-disabled`
- **测试步骤**:
  1. 设置 disabled 属性
  2. 验证 aria-disabled="true"
- **预期结果**: ARIA disabled 属性正确

### 7.3 ARIA 属性 - activedescendant

- **测试ID**: `select-aria-activedescendant`
- **测试步骤**:
  1. 打开下拉菜单
  2. 使用箭头键导航
  3. 验证 aria-activedescendant 指向当前高亮选项
- **预期结果**: ARIA activedescendant 正确

### 7.4 键盘完全可访问

- **测试ID**: `select-keyboard-accessible`
- **测试步骤**:
  1. 仅使用键盘操作选择器
  2. Tab 聚焦、Enter 展开、箭头导航、Enter 选择
  3. 验证所有功能都可用
- **预期结果**: 完全支持键盘操作

### 7.5 屏幕阅读器

- **测试ID**: `select-screen-reader`
- **测试步骤**:
  1. 使用屏幕阅读器
  2. 验证选择器状态被正确读取
  3. 验证选项被正确读取
- **预期结果**: 屏幕阅读器支持良好

## 8. 样式测试

### 8.1 CSS Parts

- **测试ID**: `select-css-parts`
- **测试步骤**:
  1. 使用 CSS Parts 自定义样式
  2. 验证样式生效
- **预期结果**: CSS Parts 可自定义样式

### 8.2 CSS 变量

- **测试ID**: `select-css-variables`
- **测试步骤**:
  1. 设置 CSS 变量
  2. 验证样式变化
- **预期结果**: CSS 变量可自定义样式

## 9. 性能测试

### 9.1 大量选项渲染性能

- **测试ID**: `select-performance-render`
- **测试步骤**:
  1. 渲染包含 10000 个选项的选择器
  2. 测量渲染时间
  3. 验证虚拟滚动生效
- **预期结果**: 大量选项渲染流畅

### 9.2 搜索过滤性能

- **测试ID**: `select-performance-filter`
- **测试步骤**:
  1. 在大量选项中进行搜索
  2. 验证过滤响应迅速
- **预期结果**: 搜索过滤性能良好

## 10. 下拉菜单定位测试

### 10.1 自动定位

- **测试ID**: `select-auto-placement`
- **测试步骤**:
  1. 在页面底部渲染选择器
  2. 打开下拉菜单
  3. 验证菜单向上展开（避免溢出）
- **预期结果**: 自动调整菜单位置

### 10.2 滚动容器内定位

- **测试ID**: `select-scroll-container`
- **测试步骤**:
  1. 在滚动容器内渲染选择器
  2. 打开下拉菜单
  3. 滚动容器
  4. 验证菜单位置跟随或正确定位
- **预期结果**: 滚动时菜单位置正确

## 测试覆盖率目标

- **功能覆盖率**: 100%
- **属性覆盖率**: 100%
- **事件覆盖率**: 100%
- **边界情况覆盖率**: ≥ 90%
- **可访问性覆盖率**: 100%

## 自动化测试建议

1. 使用 Puppeteer 进行 E2E 测试
2. 使用 Jest 进行单元测试
3. 使用 Axe 进行可访问性测试
4. 测试虚拟滚动性能
5. 测试下拉菜单定位算法
