# Modal 模态框组件测试用例

## 组件信息

- **组件名称**: nv-modal
- **组件路径**: `src/components/modal`
- **测试优先级**: P0 (高优先级)
- **组件描述**: 在保留当前页面状态的情况下，告知用户并承载相关操作

## 1. 功能测试

### 1.1 基础渲染

- **测试ID**: `modal-basic-render`
- **测试步骤**:
  1. 设置 visible 为 true
  2. 验证模态框显示
  3. 验证遮罩层显示
- **预期结果**: 模态框和遮罩层正常显示

### 1.2 打开/关闭

- **测试ID**: `modal-toggle`
- **测试步骤**:
  1. 设置 visible 为 true 打开模态框
  2. 验证模态框显示
  3. 设置 visible 为 false 关闭模态框
  4. 验证模态框隐藏
- **预期结果**: 模态框可以正常打开和关闭

### 1.3 点击遮罩关闭

- **测试ID**: `modal-close-on-mask-click`
- **测试步骤**:
  1. 设置 close-on-click-modal 为 true
  2. 打开模态框
  3. 点击遮罩层
  4. 验证模态框关闭
- **预期结果**: 点击遮罩层关闭模态框

### 1.4 ESC 键关闭

- **测试ID**: `modal-close-on-esc`
- **测试步骤**:
  1. 设置 close-on-press-escape 为 true
  2. 打开模态框
  3. 按 ESC 键
  4. 验证模态框关闭
- **预期结果**: ESC 键关闭模态框

## 2. 属性测试

### 2.1 visible 属性 (v-model)

- **测试ID**: `modal-visible`
- **测试步骤**:
  1. 设置 visible 为 true
  2. 验证模态框显示
  3. 设置 visible 为 false
  4. 验证模态框隐藏
- **预期结果**: visible 控制模态框显示/隐藏

### 2.2 label 属性 - 标题

- **测试ID**: `modal-title`
- **测试步骤**:
  1. 设置 title 属性
  2. 打开模态框
  3. 验证标题正确显示
- **预期结果**: 标题正确显示

### 2.3 width 属性 - 宽度

- **测试ID**: `modal-width`
- **测试步骤**:
  1. 设置 width="50%"
  2. 打开模态框
  3. 验证模态框宽度为 50%
- **预期结果**: 宽度正确设置

### 2.4 fullscreen 属性 - 全屏

- **测试ID**: `modal-fullscreen`
- **测试步骤**:
  1. 设置 fullscreen 为 true
  2. 打开模态框
  3. 验证模态框全屏显示
- **预期结果**: 模态框全屏显示

### 2.5 top 属性 - 距离顶部

- **测试ID**: `modal-top`
- **测试步骤**:
  1. 设置 top="15vh"
  2. 打开模态框
  3. 验证模态框距离顶部 15vh
- **预期结果**: 顶部距离正确设置

### 2.6 modal 属性 - 遮罩层

- **测试ID**: `modal-mask`
- **测试步骤**:
  1. 设置 modal 为 false
  2. 打开模态框
  3. 验证无遮罩层
- **预期结果**: 可以控制是否显示遮罩层

### 2.7 modal-append-to-body 属性

- **测试ID**: `modal-append-to-body`
- **测试步骤**:
  1. 设置 modal-append-to-body 为 true
  2. 打开模态框
  3. 验证遮罩层添加到 body
- **预期结果**: 遮罩层正确添加到 body

### 2.8 append-to-body 属性

- **测试ID**: `modal-append-to-body-self`
- **测试步骤**:
  1. 设置 append-to-body 为 true
  2. 打开模态框
  3. 验证模态框添加到 body
- **预期结果**: 模态框正确添加到 body

### 2.9 lock-scroll 属性 - 锁定滚动

- **测试ID**: `modal-lock-scroll`
- **测试步骤**:
  1. 设置 lock-scroll 为 true
  2. 打开模态框
  3. 尝试滚动页面
  4. 验证页面滚动被锁定
- **预期结果**: 页面滚动被锁定

### 2.10 close-on-click-modal 属性

- **测试ID**: `modal-close-on-click-modal`
- **测试步骤**:
  1. 设置 close-on-click-modal 为 false
  2. 打开模态框
  3. 点击遮罩层
  4. 验证模态框不关闭
- **预期结果**: 可以控制点击遮罩是否关闭

### 2.11 close-on-press-escape 属性

- **测试ID**: `modal-close-on-press-escape`
- **测试步骤**:
  1. 设置 close-on-press-escape 为 false
  2. 打开模态框
  3. 按 ESC 键
  4. 验证模态框不关闭
- **预期结果**: 可以控制 ESC 键是否关闭

### 2.12 show-close 属性 - 关闭按钮

- **测试ID**: `modal-show-close`
- **测试步骤**:
  1. 设置 show-close 为 false
  2. 打开模态框
  3. 验证无关闭按钮
- **预期结果**: 可以控制是否显示关闭按钮

### 2.13 center 属性 - 居中

- **测试ID**: `modal-center`
- **测试步骤**:
  1. 设置 center 为 true
  2. 打开模态框
  3. 验证标题和底部居中
- **预期结果**: 内容居中显示

### 2.14 destroy-on-close 属性

- **测试ID**: `modal-destroy-on-close`
- **测试步骤**:
  1. 设置 destroy-on-close 为 true
  2. 打开模态框
  3. 关闭模态框
  4. 验证 DOM 被销毁
- **预期结果**: 关闭时销毁 DOM

## 3. 事件测试

### 3.1 open 事件

- **测试ID**: `modal-event-open`
- **测试步骤**:
  1. 监听 open 事件
  2. 打开模态框
  3. 验证 open 事件触发
- **预期结果**: 打开时触发 open 事件

### 3.2 opened 事件

- **测试ID**: `modal-event-opened`
- **测试步骤**:
  1. 监听 opened 事件
  2. 打开模态框
  3. 等待动画完成
  4. 验证 opened 事件触发
- **预期结果**: 打开动画完成后触发 opened 事件

### 3.3 close 事件

- **测试ID**: `modal-event-close`
- **测试步骤**:
  1. 监听 close 事件
  2. 关闭模态框
  3. 验证 close 事件触发
- **预期结果**: 关闭时触发 close 事件

### 3.4 closed 事件

- **测试ID**: `modal-event-closed`
- **测试步骤**:
  1. 监听 closed 事件
  2. 关闭模态框
  3. 等待动画完成
  4. 验证 closed 事件触发
- **预期结果**: 关闭动画完成后触发 closed 事件

## 4. 插槽测试

### 4.1 默认插槽

- **测试ID**: `modal-slot-default`
- **测试步骤**:
  1. 在默认插槽中添加内容
  2. 打开模态框
  3. 验证内容正确显示
- **预期结果**: 默认插槽内容正确显示

### 4.2 header 插槽

- **测试ID**: `modal-slot-header`
- **测试步骤**:
  1. 使用 header 插槽自定义标题
  2. 打开模态框
  3. 验证自定义标题显示
- **预期结果**: header 插槽正确工作

### 4.3 footer 插槽

- **测试ID**: `modal-slot-footer`
- **测试步骤**:
  1. 使用 footer 插槽自定义底部
  2. 打开模态框
  3. 验证自定义底部显示
- **预期结果**: footer 插槽正确工作

## 5. 交互测试

### 5.1 点击关闭按钮

- **测试ID**: `modal-click-close-button`
- **测试步骤**:
  1. 打开模态框
  2. 点击右上角关闭按钮
  3. 验证模态框关闭
- **预期结果**: 点击关闭按钮关闭模态框

### 5.2 点击遮罩层

- **测试ID**: `modal-click-mask`
- **测试步骤**:
  1. 设置 close-on-click-modal 为 true
  2. 打开模态框
  3. 点击遮罩层
  4. 验证模态框关闭
- **预期结果**: 点击遮罩层关闭模态框

### 5.3 键盘 ESC 键

- **测试ID**: `modal-keyboard-esc`
- **测试步骤**:
  1. 设置 close-on-press-escape 为 true
  2. 打开模态框
  3. 按 ESC 键
  4. 验证模态框关闭
- **预期结果**: ESC 键关闭模态框

### 5.4 焦点管理

- **测试ID**: `modal-focus-management`
- **测试步骤**:
  1. 打开模态框
  2. 验证焦点移到模态框内
  3. 关闭模态框
  4. 验证焦点返回触发元素
- **预期结果**: 焦点管理正确

## 6. 边界测试

### 6.1 嵌套模态框

- **测试ID**: `modal-nested`
- **测试步骤**:
  1. 打开第一个模态框
  2. 在第一个模态框中打开第二个模态框
  3. 验证两个模态框都正常显示
  4. 验证遮罩层层级正确
- **预期结果**: 嵌套模态框正常工作

### 6.2 多个模态框

- **测试ID**: `modal-multiple`
- **测试步骤**:
  1. 同时打开多个模态框
  2. 验证所有模态框都正常显示
  3. 验证层级关系正确
- **预期结果**: 多个模态框正常工作

### 6.3 极小宽度

- **测试ID**: `modal-min-width`
- **测试步骤**:
  1. 设置非常小的 width
  2. 打开模态框
  3. 验证模态框正常显示
- **预期结果**: 极小宽度正常处理

### 6.4 极大宽度

- **测试ID**: `modal-max-width`
- **测试步骤**:
  1. 设置 width="100%"
  2. 打开模态框
  3. 验证模态框占满屏幕
- **预期结果**: 极大宽度正常处理

### 6.5 超长内容

- **测试ID**: `modal-long-content`
- **测试步骤**:
  1. 在模态框中添加超长内容
  2. 打开模态框
  3. 验证内容可以滚动
- **预期结果**: 超长内容可以滚动查看

## 7. 可访问性测试

### 7.1 ARIA 属性 - modal

- **测试ID**: `modal-aria-modal`
- **测试步骤**:
  1. 打开模态框
  2. 验证 aria-modal="true"
- **预期结果**: ARIA modal 属性正确

### 7.2 ARIA 属性 - labelledby

- **测试ID**: `modal-aria-labelledby`
- **测试步骤**:
  1. 打开模态框
  2. 验证 aria-labelledby 指向标题
- **预期结果**: ARIA labelledby 属性正确

### 7.3 焦点陷阱

- **测试ID**: `modal-focus-trap`
- **测试步骤**:
  1. 打开模态框
  2. 使用 Tab 键导航
  3. 验证焦点不会移出模态框
- **预期结果**: 焦点陷阱正常工作

### 7.4 键盘完全可访问

- **测试ID**: `modal-keyboard-accessible`
- **测试步骤**:
  1. 仅使用键盘操作模态框
  2. Tab 导航、ESC 关闭
  3. 验证所有功能都可用
- **预期结果**: 完全支持键盘操作

### 7.5 屏幕阅读器

- **测试ID**: `modal-screen-reader`
- **测试步骤**:
  1. 使用屏幕阅读器
  2. 打开模态框
  3. 验证模态框被正确读取
- **预期结果**: 屏幕阅读器支持良好

## 8. 动画测试

### 8.1 打开动画

- **测试ID**: `modal-open-animation`
- **测试步骤**:
  1. 打开模态框
  2. 验证有淡入和缩放动画
- **预期结果**: 打开动画流畅

### 8.2 关闭动画

- **测试ID**: `modal-close-animation`
- **测试步骤**:
  1. 关闭模态框
  2. 验证有淡出和缩放动画
- **预期结果**: 关闭动画流畅

## 9. 性能测试

### 9.1 快速打开关闭

- **测试ID**: `modal-performance-toggle`
- **测试步骤**:
  1. 快速连续打开关闭模态框
  2. 验证响应流畅
- **预期结果**: 快速切换响应流畅

### 9.2 大量内容渲染

- **测试ID**: `modal-performance-content`
- **测试步骤**:
  1. 在模态框中渲染大量内容
  2. 打开模态框
  3. 验证渲染流畅
- **预期结果**: 大量内容渲染流畅

## 测试覆盖率目标

- **功能覆盖率**: 100%
- **属性覆盖率**: 100%
- **事件覆盖率**: 100%
- **可访问性覆盖率**: 100%
